<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>下班倒數計時器</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    <style>
        /* Tailwind CSS CDN */
        @import url("https://cdn.tailwindcss.com");

        /* Custom styles for the timer */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Deep dark background */
            color: #e2e8f0; /* Light gray text */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background-image: radial-gradient(circle at center, #2d3748 1px, transparent 1px),
                              radial-gradient(circle at center, #2d3748 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
        }

        .container {
            background-color: #2d3748; /* Darker card background */
            border-radius: 1.5rem; /* More rounded corners */
            padding: 2.5rem; /* More padding */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            text-align: center;
            max-width: 90%;
            width: 500px; /* Fixed width for larger screens */
            border: 1px solid rgba(255, 255, 255, 0.05); /* Subtle border */
            backdrop-filter: blur(5px); /* Subtle blur effect */
            -webkit-backdrop-filter: blur(5px); /* For Safari */
            
            /* Responsive adjustments for the main container */
            max-width: 500px; /* Set a max-width to prevent it from being too wide */
            width: 90%; /* Use percentage for width to make it fluid */
        }

        .title {
            font-size: 2.5rem; /* Larger title */
            font-weight: 600;
            margin-bottom: 2rem;
            color: #a0aec0; /* Slightly lighter gray for title */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5); /* Text shadow for depth */
        }

        .countdown-display {
            display: flex;
            justify-content: center;
            gap: 1.5rem; /* More space between time units */
            margin-bottom: 2.5rem;
        }

        .time-unit {
            background-color: #4a5568; /* Slightly lighter background for units */
            padding: 1.5rem 1.8rem; /* More padding */
            border-radius: 1rem; /* Rounded corners */
            font-size: 3.5rem; /* Larger font size for digits */
            font-weight: 600;
            color: #cbd5e0; /* Lighter color for digits */
            min-width: 100px; /* Ensure consistent width */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3), 0 2px 5px rgba(0, 0, 0, 0.2); /* Inner and outer shadow */
            position: relative;
            overflow: hidden;
            box-sizing: border-box; /* Ensures padding is included in width calculation */
        }

        .time-unit::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(rgba(255, 255, 255, 0.05), transparent);
            border-radius: 1rem 1rem 0 0;
        }

        .time-label {
            font-size: 1rem;
            font-weight: 300;
            color: #a0aec0;
            margin-top: 0.5rem;
            text-transform: uppercase;
        }
        
        .time-digit {
            font-family: 'Roboto Mono', monospace; /* Using a monospace font for digits */
        }

        .quote-box {
            background-color: #2c313a; /* Even darker background for quote */
            padding: 1.5rem;
            border-radius: 1rem;
            font-style: italic;
            font-size: 1.1rem;
            color: #a0aec0; /* Slightly lighter text for quote */
            line-height: 1.6;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.4); /* Inner shadow for quote box */
            border: 1px solid rgba(255, 255, 255, 0.03); /* Very subtle border */
            margin-bottom: 1.5rem; /* Added margin for the button */
        }
        
        .buttons-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 1rem;
        }
        
        .timer-buttons-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .generate-button, .set-time-button, #saveTimeButton, #cancelTimeButton {
            background-color: #63b3ed; /* A nice blue color */
            color: #1a202c; /* Dark text for contrast */
            padding: 0.8rem 1.5rem;
            border-radius: 0.75rem; /* Rounded corners */
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        #cancelTimeButton {
            background-color: #4a5568; /* Different color for cancel button */
        }

        .generate-button:hover, .set-time-button:hover, #saveTimeButton:hover {
            background-color: #4299e1; /* Darker blue on hover */
            transform: translateY(-2px); /* Slight lift effect */
        }

        #cancelTimeButton:hover {
             background-color: #3b424d; /* Darker gray on hover */
             transform: translateY(-2px);
        }

        .generate-button:active, .set-time-button:active, #saveTimeButton:active, #cancelTimeButton:active {
            transform: translateY(0); /* Press down effect */
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #63b3ed;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
            display: none; /* Hidden by default */
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .finished-text {
            font-size: 2rem;
            font-weight: 600;
            color: #9ae6b4; /* Light green color */
            margin-bottom: 2.5rem;
            display: none;
        }
        
        .time-input-container {
            display: none; /* Hidden by default */
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .time-input-container input {
            background-color: #4a5568;
            color: #e2e8f0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0.5rem;
            border-radius: 0.5rem;
            text-align: center;
        }

        /* Responsive adjustments for mobile screens */
        @media (max-width: 640px) {
            .container {
                padding: 1.5rem;
                width: 95%; /* Make it fit almost all screen widths */
                max-width: 400px; /* Add a max-width for better control */
            }
            .title {
                font-size: 2rem;
                margin-bottom: 1.5rem;
            }
            .countdown-display, .finished-text {
                font-size: 2rem;
                margin-bottom: 1.5rem;
            }
            .countdown-display {
                flex-direction: column;
                gap: 1rem;
            }
            .time-unit {
                font-size: 3rem;
                padding: 1rem 1.2rem;
                min-width: 80px; /* Adjust min-width for mobile */
                width: 100%; /* Full width on small screens */
            }
            .quote-box {
                font-size: 1rem;
                padding: 1rem;
            }
            .buttons-container {
                flex-direction: column;
            }
            .generate-button, .set-time-button {
                width: 100%;
            }
            .timer-buttons-container {
                flex-direction: row;
                gap: 1rem;
            }
            #saveTimeButton, #cancelTimeButton {
                width: 50%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">下班倒數計時</h1>
        <div id="countdownDisplay" class="countdown-display">
            <div class="time-unit">
                <span id="hours" class="time-digit">00</span>
                <div class="time-label">小時</div>
            </div>
            <div class="time-unit">
                <span id="minutes" class="time-digit">00</span>
                <div class="time-label">分鐘</div>
            </div>
            <div class="time-unit">
                <span id="seconds" class="time-digit">00</span>
                <div class="time-label">秒</div>
            </div>
        </div>
        <div id="finishedMessage" class="finished-text">本日已下班！</div>
        <div class="quote-box">
            <p id="daily-quote"></p>
        </div>
        <div class="buttons-container">
            <button id="generateQuoteButton" class="generate-button">✨ 換一句厭世語錄 ✨</button>
            <button id="setTimeButton" class="set-time-button">⏱️ 設定下班時間</button>
        </div>
        <div id="timeInputContainer" class="time-input-container">
            <input type="time" id="customTimeInput" value="17:00">
            <div class="timer-buttons-container">
                 <button id="saveTimeButton" class="generate-button">儲存</button>
                 <button id="cancelTimeButton" class="set-time-button">取消</button>
            </div>
        </div>
        <div id="loadingSpinner" class="loading-spinner mt-4"></div>
    </div>

    <script>
        // Array of pessimistic/world-weary quotes
        const quotes = [
            "上班不要跟我談夢想，我的夢想是不上班。",
            "公司只得到我的人、得不到我的心。",
            "我不是來上班的，我是來等下班的。",
            "人生苦短，再忍一下就下班了。",
            "我的超能力就是準時下班。",
            "如果可以，我希望我的工作是睡覺。",
            "每天最期待的時刻，就是打卡下班。",
            "工作是為了生活，不是生活為了工作。",
            "我與工作的關係，就像一場漫長的單戀，我愛下班，它愛我加班。",
            "今天的工作，是為了明天更好的躺平。",
            "我的靈魂在放假，身體在上班。",
            "錢不是萬能的，但沒錢是萬萬不能的，所以只好上班。",
            "今天不想努力，只想躺平。",
            "我的夢想是財富自由，然後把鬧鐘砸了。",
            "上班就像一場馬拉松，終點是下班。",
            "我不是在上班，就是在準備下班的路上。",
            "工作再忙，也要記得呼吸，因為呼吸不用錢。",
            "我的腦袋已經下班了，身體還在堅持。",
            "我不是討厭工作，我只是討厭上班。",
            "下班的鈴聲，是世界上最美妙的音樂。",
            "我的興趣是下班，專長是準時離開。",
            "工作再累，也不能忘記下班的快樂。",
            "加班，就是用老闆的錢買我的青春，我不願意。",
            "我不是在混水摸魚，我是在努力等待下班。",
            "薪水沒有讓我富有，但下班讓我快樂。",
            "我的熱情，只存在於下班後。",
            "工作是為了付帳單，下班才是人生的開始。",
            "我的人生只有兩個模式：上班模式和下班模式，而下班模式是我的最愛。",
            "如果可以，我想把上班時間濃縮成下班時間。",
            "我的工作態度是：在下班前，把所有事都做完。",
            "我努力工作，只是為了能準時下班。",
            "我的下班時間，比我的績效更重要。",
            "我不是討厭上班，我只是對下班充滿了熱情。",
            "今天的工作，是為了明天可以繼續準時下班。",
            "下班的時鐘，是我最期待的鬧鐘。"
        ];
        
        let countdownInterval;
        let targetTime = new Date(); // Initialize with a default value

        // --- Cookie related functions ---
        function setCookie(name, value, expires) {
            document.cookie = `${name}=${value}; expires=${expires.toUTCString()}; path=/`;
        }
        
        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for(let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }

        // Function to get a random quote from the predefined list
        function getRandomQuote() {
            const randomIndex = Math.floor(Math.random() * quotes.length);
            return quotes[randomIndex];
        }

        // Function to update the countdown
        function updateCountdown() {
            const now = new Date();
            const timeLeft = targetTime.getTime() - now.getTime();

            if (timeLeft <= 0) {
                // Countdown finished
                document.getElementById('countdownDisplay').style.display = 'none';
                document.getElementById('finishedMessage').style.display = 'block';
                clearInterval(countdownInterval); // Stop the interval
                return;
            }

            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

            document.getElementById('hours').textContent = String(hours).padStart(2, '0');
            document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
        }
        
        // Function to set up the countdown
        function setupCountdown(hour = 17, minute = 0) {
            const now = new Date();
            targetTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour, minute, 0);

            // If it's already past the target time today, set target for tomorrow
            if (now.getTime() >= targetTime.getTime()) {
                targetTime.setDate(targetTime.getDate() + 1);
                document.getElementById('finishedMessage').style.display = 'block';
                document.getElementById('countdownDisplay').style.display = 'none';
            } else {
                document.getElementById('finishedMessage').style.display = 'none';
                document.getElementById('countdownDisplay').style.display = 'flex';
                // Clear any existing interval to prevent multiple timers running
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                }
                // Start a new countdown interval
                countdownInterval = setInterval(updateCountdown, 1000);
                updateCountdown(); // Initial call to display immediately
            }
        }

        // Event listener for the "Set Time" button
        document.getElementById('setTimeButton').addEventListener('click', () => {
            document.getElementById('timeInputContainer').style.display = 'flex';
            document.getElementById('generateQuoteButton').style.display = 'none';
            document.getElementById('setTimeButton').style.display = 'none';
        });

        // Event listener for the "Save" button
        document.getElementById('saveTimeButton').addEventListener('click', () => {
            const timeInput = document.getElementById('customTimeInput').value;
            const [hour, minute] = timeInput.split(':').map(Number);
            setupCountdown(hour, minute);
            
            // Set the cookie to expire at the end of the current day
            const now = new Date();
            const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0);
            setCookie('workOffTime', timeInput, tomorrow);

            // Hide input container and show buttons again
            document.getElementById('timeInputContainer').style.display = 'none';
            document.getElementById('generateQuoteButton').style.display = 'inline-block';
            document.getElementById('setTimeButton').style.display = 'inline-block';
        });
        
        // Event listener for the "Cancel" button
        document.getElementById('cancelTimeButton').addEventListener('click', () => {
            // Just hide the input container and show buttons
            document.getElementById('timeInputContainer').style.display = 'none';
            document.getElementById('generateQuoteButton').style.display = 'inline-block';
            document.getElementById('setTimeButton').style.display = 'inline-block';
        });
        
        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Initial display of a random quote
            document.getElementById('daily-quote').textContent = getRandomQuote();

            // Add event listener to the generate button
            document.getElementById('generateQuoteButton').addEventListener('click', () => {
                document.getElementById('daily-quote').textContent = getRandomQuote();
            });

            // Check for existing cookie and set up the countdown
            const savedTime = getCookie('workOffTime');
            if (savedTime) {
                const [hour, minute] = savedTime.split(':').map(Number);
                setupCountdown(hour, minute);
                // Also update the input field to show the saved time
                document.getElementById('customTimeInput').value = savedTime;
            } else {
                setupCountdown(17, 0); // Default to 5 PM
            }
        });
    </script>
</body>
</html>
